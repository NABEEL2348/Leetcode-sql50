WITH START_TIMES AS (
    SELECT MACHINE_ID , PROCESS_ID , TIMESTAMP AS START_TIME FROM ACTIVITY WHERE ACTIVITY_TYPE = 'START' 
),
END_TIMES AS(
    SELECT MACHINE_ID , PROCESS_ID , TIMESTAMP AS END_TIME FROM ACTIVITY WHERE ACTIVITY_TYPE = 'END'
)
SELECT START_TIMES.MACHINE_ID,ROUND(AVG(END_TIMES.END_TIME - START_TIMES.START_TIME),3) AS PROCESSING_TIME FROM START_TIMES JOIN END_TIMES ON  START_TIMES.MACHINE_ID=END_TIMES.MACHINE_ID AND START_TIMES.PROCESS_ID=END_TIMES.PROCESS_ID GROUP BY START_TIMES.MACHINE_ID ;